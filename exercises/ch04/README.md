# 練習問題: 4 章

## 問題 4.1 💻🧪

実部と虚部をプロパティとして持つ 2 つの複素数オブジェクトを引数として四則演算の結果を返す関数 `add`、`sub`、`mul`、`div` を実装しなさい。

**出題範囲**: 4.3

## 問題 4.2 💻

三項演算子を用いた複雑な式は可読性が低く、一般的に避けたほうが良いとされている。
複雑な式の例として、以下のプログラムは 1 から 100 までの [FizzBuzz](https://ja.wikipedia.org/wiki/Fizz_Buzz) を出力する。
このプログラムを三項演算子のかわりに `if` 文を用いて実装し直しなさい。

```javascript
for (i = 1; i < 101; i++)
  console.log(i % 15 ? (i % 3 ? (i % 5 ? i : "Buzz") : "Fizz") : "FizzBuzz");
```

**出題範囲**: 4.7

## 問題 4.3 💻🧪💪

ビット演算子はオペランドを 32 ビット整数表現形式で表わされているものとして処理を行う。以下は 32 ビット整数表現形式の例である:

| 整数 | 32 ビット整数表現 (2 進数)         |
| ---- | ---------------------------------- |
| `0`  | `00000000000000000000000000000000` |
| `1`  | `00000000000000000000000000000001` |
| `5`  | `00000000000000000000000000000101` |
| `42` | `00000000000000000000000000101010` |
| `-1` | `11111111111111111111111111111111` |
| `-5` | `11111111111111111111111111111011` |

上記の `-1` や `-5` が分からない場合は [2 の補数](https://ja.wikipedia.org/wiki/2%E3%81%AE%E8%A3%9C%E6%95%B0) を参照しなさい。

一般に計算機では負の数を表現するために 2 の補数が利用される。
例えば Java で `int x = -5;` といったプログラムを書くと、メモリ上に `11111111111111111111111111111011` といった 32 ビットの値が保存されると考えてよい。

注意: JavaScript の値は内部的に 32 ビット整数表現で保存されているわけではない。興味がある場合は [Pointer Compression in V8](https://v8.dev/blog/pointer-compression) などを参照しなさい。

2 の補数表現のメリットとして四則演算が簡単に出来ることが挙げられる。例えば 8 - 3 を考える。これを 8 + (-3) と考えて計算する:

```text
  00000000000000000000000000001000
+ 11111111111111111111111111111101
----------------------------------
 100000000000000000000000000000101
```

桁溢れを無視すれば計算結果は `00000000000000000000000000000101` となり、これは `5` である。
このように 2 の補数表現によって減算が加算と同じ仕組みで実現できる。

では実際に 2 の補数とビット演算を用いた以下の問題に回答しなさい。
ビット演算のみを用いて減算を行う関数 `sub` を実装しなさい (例: `sub(8, 3)` は `5` を返すものとする)。
演算子として用いて良いのは `&`, `|`, `^`, `~`, `<<`, `>>`, `>>>` だけとする (`+` や `===` 等は禁止)。

ヒント: 与えられた数の 2 の補数はビットの 0, 1 を反転し、1 を加えることで求められる。

**出題範囲**: 4.8

## 問題 4.4 💻🧪

与えられた数値を 32 ビット整数表現形式で表現した場合に 1 であるビットの数を返す関数 `bitCount` を書きなさい。

例として `bitCount(0b111)` は 3 を返し、`bitCount(0b1111111111111111111111111111111)` は `31` を返しなさい。

**出題範囲**: 4.8

## 問題 4.5 🖋️

以下のプログラムは 1 から 100 までの FizzBuzz を出力する。
Fizz、Buzz、FizzBuzz、数値、それぞれのケースで式がどのように評価されるか言及しつつ処理を説明しなさい。

```javascript
for (i = 1; i < 101; i++)
  console.log((i % 3 ? "" : "Fizz") + (i % 5 ? "" : "Buzz") || i);
```

**出題範囲**: 4.10

## 問題 4.6 💻

以下の `resize` 関数を書き直した 2 つの関数を作成しなさい

- `if` を利用せず `&&` や `||` を用いて `maxWidth` や `maxHeight` を設定する関数 (`resize1`)
- `if` を利用せず `?.` や `??` を用いて `maxWidth` や `maxHeight` を設定する関数 (`resize2`)

```js
// 何らかのリサイズを行う関数と思って読んで下さい
//
// - params には undefined またはオブジェクトが与えられる
// - params.maxWidth が与えられる場合 (正の整数と仮定して良い) はその値を利用する
// - params.maxHeight が与えられる場合 (正の整数と仮定して良い) はその値を利用する
function resize(params) {
  let maxWidth = 600;
  let maxHeight = 480;

  if (params && params.maxWidth) {
    maxWidth = params.maxWidth;
  }

  if (params && params.maxHeight) {
    maxHeight = params.maxHeight;
  }

  console.log({ maxWidth, maxHeight });
}
```

**出題範囲**: 4.10.2

## 問題 4.7 🖋️

`eval` は大変危険な関数である。以下の関数 `set42` は与えられた文字列の変数に `42` を代入する。

```js
// このような関数は絶対に書いてはならない。
function set42(key) {
  eval(`${key} = 42;`);
}

// 例:
set42("hello");
console.log(hello); // 42
```

`set42` に意図せぬ動作 (例: システムに負荷を与える、セキュリティの問題となる挙動を取る) を行わさせるにはどのような引数を与えればいいか答えなさい。
ただし実行時エラーが発生しない引数としなさい。

**出題範囲**: 4.12

## 問題 4.8 🖋️

古い JavaScript のコードでは `undefined` と比較を行う際に:

```js
if (foo === undefined) { ... }
```

ではなく以下のように書かれたコードを見ることがある (注: `void 0` は `undefined` を返す)。

```js
if (foo === void 0) { ... }
```

これにはどのような理由があるか、また今ではこのような書き方をしないのは何故か調べて回答しなさい。

**出題範囲**: 4.13

## 問題 4.9 💻

typeof 演算子のオペランドに、`undefined`, `null`, `オブジェクト`, `NaN`, `数値`, `関数` を指定したときの返り値を予想しなさい。
その後実装しコンソール出力で確認しなさい。

**出題範囲**: 4.13.3

## 問題 4.10 💻

配列 `["r", "i", "c", "o", "h"]` の `"o"` の要素を `delete` で削除したとき、削除後の配列の内容と `length` の値をコンソール出力で確認しなさい。

**出題範囲**: 4.13.4
